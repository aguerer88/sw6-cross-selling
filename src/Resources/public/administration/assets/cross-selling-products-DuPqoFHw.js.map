{"version":3,"file":"cross-selling-products-DuPqoFHw.js","sources":["../../../app/administration/src/module/sw-category/component/sw-category-view/sw-category-view.html.twig","../../../app/administration/src/module/sw-category/component/sw-category-view/index.js","../../../app/administration/src/module/sw-category/view/sw-category-cross-selling/sw-category-detail-cross.html.twig","../../../app/administration/src/module/sw-category/view/sw-category-cross-selling/index.js","../../../app/administration/src/main.js"],"sourcesContent":["{% block sw_category_view_tabs_seo %}\n\n    {% parent %}\n\n    <sw-tabs-item\n        class=\"sw-category-detail__tab-cross\"\n        :route=\"{ name: 'sw.category.detail.cross', params: { id: category.id } }\"\n        :title=\"Cross-Selling\">\n        Cross Selling\n    </sw-tabs-item>\n{% endblock %}\n","import template from './sw-category-view.html.twig';\n\nShopware.Component.override('sw-category-view', {\n    template\n});\n","<template v-for=\"(group, index) in groups\" :key=\"group.id\">\n    <sw-card title=\"Neues Cross Selling\" :hero=\"false\" :isLoading=\"false\" :large=\"false\">\n        <template #headerRight>\n            <div class=\"sw-product-detail-cross-selling__context-button\">\n                <sw-context-button>\n                    <sw-context-menu-item\n                        variant=\"danger\"\n                        class=\"sw-product-cross_selling-context-item__delete-action\"\n                        @click=\"removeGroup(index)\"\n                    >\n                        delete\n                    </sw-context-menu-item>\n                </sw-context-button>\n            </div>\n        </template>\n        <sw-container columns=\"1fr 1fr\" gap=\"0px 30px\" align=\"start\">\n            <mt-text-field\n                v-model=\"group.name\"\n                name=\"sw-field--crossSelling-group\"\n                :label=\"'Titel'\"\n                required\n                :placeholder=\"'Gib einen namen ein'\"\n            />\n            <mt-number-field\n                v-model=\"group.position\"\n                number-type=\"int\"\n                :min=\"1\"\n                :max=\"2\"\n                :label=\"'Position'\"\n                :placeholder=\"'1'\"\n            />\n            <sw-entity-single-select\n                id=\"sw-field--group-product-group\"\n                v-model:value=\"group.productStreamId\"\n                entity=\"product_stream\"\n                class=\"sw-select-cross-selling__select-product-stream\"\n                :label=\"'Dynamische Produktgruppe'\"\n                :placeholder=\"'Produktgruppe auswählen'\"\n            </sw-entity-single-select>      \n\n            <sw-entity-multi-id-select\n                label=\"Bis zu 3 Produkte\"\n                :repository=\"productRepository\"\n                :criteria=\"productCriteria\"\n                v-model:value=\"group.productIds\"\n                placeholder=\"Produkte auswählen\"\n                :max-selection=\"3\"\n                label-property=\"name\">\n            </sw-entity-multi-id-select>\n\n            <sw-button @click=\"onSave\">Konfiguration speichern</sw-button>                      \n        </sw-container>       \n    </sw-card>\n</template>\n<div style=\"display: flex; justify-content: center; margin-top: 20px;\">\n    <sw-button @click=\"addGroup\">Gruppe hinzufügen</sw-button>\n</div>\n\n","import template from './sw-category-detail-cross.html.twig';\n\nShopware.Component.register('sw-category-detail-cross', {\n    template,\n\n    inject: ['repositoryFactory'],\n    mixins: [Shopware.Mixin.getByName('notification')],\n\n    data() {\n        return {\n            groups: [],\n            categoryId: null,\n            productCriteria: null,\n            isLoading: false,\n        };\n    },\n\n    computed: {\n        crossSellingGroupRepository() {\n            return this.repositoryFactory.create('cross_selling_product_group');\n        },\n\n        productRepository() {\n            return this.repositoryFactory.create('product');\n        },\n    },\n\n    created() {\n        this.categoryId = this.$route.params.id;\n        this.initCriteria();\n        this.loadGroups();\n    },\n\n    methods: {\n        initCriteria() {\n            this.productCriteria = new Shopware.Data.Criteria();\n            this.productCriteria.addFilter(Shopware.Data.Criteria.equals('active', true));\n        },\n\n        loadGroups() {\n            const criteria = new Shopware.Data.Criteria();\n            criteria.addFilter(Shopware.Data.Criteria.equals('categoryId', this.categoryId));\n            criteria.addSorting(Shopware.Data.Criteria.sort('position', 'ASC'));\n\n            this.crossSellingGroupRepository.search(criteria, Shopware.Context.api).then((result) => {\n                if (Array.isArray(result)) {\n                    this.groups = result;\n                } else {\n                    this.groups = [];\n                    this.createNotificationError({\n                        title: 'Fehler',\n                        message: 'Unbekanntes Resultatformat bei Suche'\n                    });\n                }\n            });\n        },\n\n        addGroup() {\n            const newGroup = this.crossSellingGroupRepository.create(Shopware.Context.api);\n            newGroup.categoryId = this.categoryId;\n            newGroup.position = this.groups.length + 1;\n            newGroup.productIds = [];\n\n            this.groups.push(newGroup);\n        },\n\n        removeGroup(index) {\n            const group = this.groups[index];\n            if (group.id) {\n                this.crossSellingGroupRepository.delete(group.id, Shopware.Context.api).then(() => {\n                    this.groups.splice(index, 1);\n                });\n            } else {\n                this.groups.splice(index, 1);\n            }\n        },\n\n        async onSave() {\n            this.isLoading = true;\n            try {\n                for (const group of this.groups) {\n                    await this.crossSellingGroupRepository.save(group, Shopware.Context.api);\n                }\n\n                this.createNotificationSuccess({\n                    title: 'Erfolg',\n                    message: 'Cross Selling Produkte erfolgreich angelegt.'\n                });\n\n                this.loadGroups();\n\n            } catch (error) {\n                this.createNotificationError({\n                    title: 'Fehler',\n                    message: 'Die Cross Selling Produkte konnten nicht angelegt werden.'\n                });\n                console.error(error);\n            } finally {\n                this.isLoading = false;\n            }\n        },\n    }\n});\n","import './module/sw-category/component/sw-category-view';\nimport './module/sw-category/view/sw-category-cross-selling';\n\nShopware.Module.register('sw-category-cross-selling', {\n    routeMiddleware(next, currentRoute) {\n        const customRouteName = 'sw.category.detail.cross';\n\n        if (\n            currentRoute.name === 'sw.category.detail' &&\n            currentRoute.children.every((route) => route.name !== customRouteName)\n        ) {\n            currentRoute.children.push({\n                name: customRouteName,\n                path: 'cross-selling',\n                component: 'sw-category-detail-cross',\n                meta: {\n                    parentPath: 'sw.category.index'\n                }\n            });\n        }\n\n        next(currentRoute);\n    }\n});"],"names":["template$1","template","criteria","result","newGroup","index","group","error","next","currentRoute","customRouteName","route"],"mappings":"AAAA,MAAeA,EAAA,yPCEf,SAAS,UAAU,SAAS,mBAAoB,CAC5CC,SAAAA,CACJ,CAAC,ECJD,MAAeA,EAAA,0gDCEf,SAAS,UAAU,SAAS,2BAA4B,CACpD,SAAAA,EAEA,OAAQ,CAAC,mBAAmB,EAC5B,OAAQ,CAAC,SAAS,MAAM,UAAU,cAAc,CAAC,EAEjD,MAAO,CACH,MAAO,CACH,OAAQ,CAAE,EACV,WAAY,KACZ,gBAAiB,KACjB,UAAW,EACd,CACJ,EAED,SAAU,CACN,6BAA8B,CAC1B,OAAO,KAAK,kBAAkB,OAAO,6BAA6B,CACrE,EAED,mBAAoB,CAChB,OAAO,KAAK,kBAAkB,OAAO,SAAS,CACjD,CACJ,EAED,SAAU,CACN,KAAK,WAAa,KAAK,OAAO,OAAO,GACrC,KAAK,aAAc,EACnB,KAAK,WAAY,CACpB,EAED,QAAS,CACL,cAAe,CACX,KAAK,gBAAkB,IAAI,SAAS,KAAK,SACzC,KAAK,gBAAgB,UAAU,SAAS,KAAK,SAAS,OAAO,SAAU,EAAI,CAAC,CAC/E,EAED,YAAa,CACT,MAAMC,EAAW,IAAI,SAAS,KAAK,SACnCA,EAAS,UAAU,SAAS,KAAK,SAAS,OAAO,aAAc,KAAK,UAAU,CAAC,EAC/EA,EAAS,WAAW,SAAS,KAAK,SAAS,KAAK,WAAY,KAAK,CAAC,EAElE,KAAK,4BAA4B,OAAOA,EAAU,SAAS,QAAQ,GAAG,EAAE,KAAMC,GAAW,CACjF,MAAM,QAAQA,CAAM,EACpB,KAAK,OAASA,GAEd,KAAK,OAAS,CAAE,EAChB,KAAK,wBAAwB,CACzB,MAAO,SACP,QAAS,sCACjC,CAAqB,EAErB,CAAa,CACJ,EAED,UAAW,CACP,MAAMC,EAAW,KAAK,4BAA4B,OAAO,SAAS,QAAQ,GAAG,EAC7EA,EAAS,WAAa,KAAK,WAC3BA,EAAS,SAAW,KAAK,OAAO,OAAS,EACzCA,EAAS,WAAa,CAAE,EAExB,KAAK,OAAO,KAAKA,CAAQ,CAC5B,EAED,YAAYC,EAAO,CACf,MAAMC,EAAQ,KAAK,OAAOD,CAAK,EAC3BC,EAAM,GACN,KAAK,4BAA4B,OAAOA,EAAM,GAAI,SAAS,QAAQ,GAAG,EAAE,KAAK,IAAM,CAC/E,KAAK,OAAO,OAAOD,EAAO,CAAC,CAC/C,CAAiB,EAED,KAAK,OAAO,OAAOA,EAAO,CAAC,CAElC,EAED,MAAM,QAAS,CACX,KAAK,UAAY,GACjB,GAAI,CACA,UAAWC,KAAS,KAAK,OACrB,MAAM,KAAK,4BAA4B,KAAKA,EAAO,SAAS,QAAQ,GAAG,EAG3E,KAAK,0BAA0B,CAC3B,MAAO,SACP,QAAS,8CAC7B,CAAiB,EAED,KAAK,WAAY,CAEpB,OAAQC,EAAO,CACZ,KAAK,wBAAwB,CACzB,MAAO,SACP,QAAS,2DAC7B,CAAiB,EACD,QAAQ,MAAMA,CAAK,CACnC,QAAsB,CACN,KAAK,UAAY,EACjC,CACS,CACT,CACA,CAAC,ECnGD,SAAS,OAAO,SAAS,4BAA6B,CAClD,gBAAgBC,EAAMC,EAAc,CAChC,MAAMC,EAAkB,2BAGpBD,EAAa,OAAS,sBACtBA,EAAa,SAAS,MAAOE,GAAUA,EAAM,OAASD,CAAe,GAErED,EAAa,SAAS,KAAK,CACvB,KAAMC,EACN,KAAM,gBACN,UAAW,2BACX,KAAM,CACF,WAAY,mBAChC,CACA,CAAa,EAGLF,EAAKC,CAAY,CACzB,CACA,CAAC"}